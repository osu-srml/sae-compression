{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 125,
    "llm_batch_size": 32,
    "llm_dtype": "bfloat16",
    "lower_vram_usage": false,
    "model_name": "gemma-2-2b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "376e422b-7bd0-4da6-bb02-0cc007eaae8c",
  "datetime_epoch_millis": 1742870148128,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.0025249972939491274,
      "tpp_threshold_2_intended_diff_only": 0.0035999953746795655,
      "tpp_threshold_2_unintended_diff_only": 0.0010749980807304381,
      "tpp_threshold_5_total_metric": 0.003899997472763061,
      "tpp_threshold_5_intended_diff_only": 0.004799991846084595,
      "tpp_threshold_5_unintended_diff_only": 0.0008999943733215333,
      "tpp_threshold_10_total_metric": 0.00440000295639038,
      "tpp_threshold_10_intended_diff_only": 0.005000001192092896,
      "tpp_threshold_10_unintended_diff_only": 0.0005999982357025147,
      "tpp_threshold_20_total_metric": 0.0071750074625015255,
      "tpp_threshold_20_intended_diff_only": 0.009400004148483276,
      "tpp_threshold_20_unintended_diff_only": 0.0022249966859817505,
      "tpp_threshold_50_total_metric": 0.023350004851818085,
      "tpp_threshold_50_intended_diff_only": 0.02709999680519104,
      "tpp_threshold_50_unintended_diff_only": 0.0037499919533729555,
      "tpp_threshold_100_total_metric": 0.06852499544620513,
      "tpp_threshold_100_intended_diff_only": 0.07399999499320983,
      "tpp_threshold_100_unintended_diff_only": 0.0054749995470047,
      "tpp_threshold_500_total_metric": 0.3031750306487083,
      "tpp_threshold_500_intended_diff_only": 0.34260002374649046,
      "tpp_threshold_500_unintended_diff_only": 0.039424993097782135
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.0015500128269195558,
      "tpp_threshold_2_intended_diff_only": 0.0040000081062316895,
      "tpp_threshold_2_unintended_diff_only": 0.0024499952793121337,
      "tpp_threshold_5_total_metric": -0.0006000012159347534,
      "tpp_threshold_5_intended_diff_only": 0.0023999929428100584,
      "tpp_threshold_5_unintended_diff_only": 0.002999994158744812,
      "tpp_threshold_10_total_metric": 0.002450001239776611,
      "tpp_threshold_10_intended_diff_only": 0.0037999987602233888,
      "tpp_threshold_10_unintended_diff_only": 0.0013499975204467774,
      "tpp_threshold_20_total_metric": 0.00045000910758972166,
      "tpp_threshold_20_intended_diff_only": 0.004400002956390381,
      "tpp_threshold_20_unintended_diff_only": 0.003949993848800659,
      "tpp_threshold_50_total_metric": 0.0111500084400177,
      "tpp_threshold_50_intended_diff_only": 0.013999998569488525,
      "tpp_threshold_50_unintended_diff_only": 0.0028499901294708253,
      "tpp_threshold_100_total_metric": 0.03619998991489411,
      "tpp_threshold_100_intended_diff_only": 0.0403999924659729,
      "tpp_threshold_100_unintended_diff_only": 0.004200002551078797,
      "tpp_threshold_500_total_metric": 0.2958000242710114,
      "tpp_threshold_500_intended_diff_only": 0.31220000982284546,
      "tpp_threshold_500_unintended_diff_only": 0.016399985551834105
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.0034999817609786986,
      "tpp_threshold_2_intended_diff_only": 0.0031999826431274416,
      "tpp_threshold_2_unintended_diff_only": -0.0002999991178512573,
      "tpp_threshold_5_total_metric": 0.008399996161460876,
      "tpp_threshold_5_intended_diff_only": 0.007199990749359131,
      "tpp_threshold_5_unintended_diff_only": -0.0012000054121017456,
      "tpp_threshold_10_total_metric": 0.00635000467300415,
      "tpp_threshold_10_intended_diff_only": 0.0062000036239624025,
      "tpp_threshold_10_unintended_diff_only": -0.00015000104904174804,
      "tpp_threshold_20_total_metric": 0.01390000581741333,
      "tpp_threshold_20_intended_diff_only": 0.014400005340576172,
      "tpp_threshold_20_unintended_diff_only": 0.0004999995231628418,
      "tpp_threshold_50_total_metric": 0.03555000126361847,
      "tpp_threshold_50_intended_diff_only": 0.040199995040893555,
      "tpp_threshold_50_unintended_diff_only": 0.004649993777275085,
      "tpp_threshold_100_total_metric": 0.10085000097751617,
      "tpp_threshold_100_intended_diff_only": 0.10759999752044677,
      "tpp_threshold_100_unintended_diff_only": 0.006749996542930603,
      "tpp_threshold_500_total_metric": 0.3105500370264053,
      "tpp_threshold_500_intended_diff_only": 0.3730000376701355,
      "tpp_threshold_500_unintended_diff_only": 0.062450000643730165
    }
  ],
  "sae_bench_commit_hash": "c5c90a136c8db8e704e401328a49b19932ad56c9",
  "sae_lens_id": "blocks.12.hook_mlp_out",
  "sae_lens_release_id": "suchitg/sae-compression-gemma-2-2b-trained-sae-pile-wanda",
  "sae_lens_version": "5.6.1",
  "sae_cfg_dict": {
    "architecture": "jumprelu",
    "d_in": 2304,
    "d_sae": 16384,
    "activation_fn_str": "relu",
    "apply_b_dec_to_input": false,
    "finetuning_scaling_factor": false,
    "context_size": 1024,
    "model_name": "gemma-2-2b",
    "hook_name": "blocks.12.hook_mlp_out",
    "hook_layer": 12,
    "hook_head_index": null,
    "prepend_bos": true,
    "dataset_path": "monology/pile-uncopyrighted",
    "dataset_trust_remote_code": true,
    "normalize_activations": "none",
    "dtype": "torch.bfloat16",
    "device": "cuda",
    "sae_lens_training_version": "5.5.2",
    "activation_fn_kwargs": {},
    "neuronpedia_id": null,
    "model_from_pretrained_kwargs": {
      "center_writing_weights": false
    },
    "seqpos_slice": [
      null
    ]
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": -0.00849999487400055,
        "tpp_threshold_2_intended_diff_only": -0.004999995231628418,
        "tpp_threshold_2_unintended_diff_only": 0.0034999996423721313,
        "tpp_threshold_5_total_metric": -0.0017500072717666626,
        "tpp_threshold_5_intended_diff_only": 0.0,
        "tpp_threshold_5_unintended_diff_only": 0.0017500072717666626,
        "tpp_threshold_10_total_metric": 0.006499975919723511,
        "tpp_threshold_10_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_10_unintended_diff_only": -0.0004999935626983643,
        "tpp_threshold_20_total_metric": -0.0020000189542770386,
        "tpp_threshold_20_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_20_unintended_diff_only": 0.008000001311302185,
        "tpp_threshold_50_total_metric": 0.027499988675117493,
        "tpp_threshold_50_intended_diff_only": 0.02899998426437378,
        "tpp_threshold_50_unintended_diff_only": 0.0014999955892562866,
        "tpp_threshold_100_total_metric": 0.07525002956390381,
        "tpp_threshold_100_intended_diff_only": 0.0820000171661377,
        "tpp_threshold_100_unintended_diff_only": 0.006749987602233887,
        "tpp_threshold_500_total_metric": 0.41300003230571747,
        "tpp_threshold_500_intended_diff_only": 0.42900002002716064,
        "tpp_threshold_500_unintended_diff_only": 0.015999987721443176
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.0022500306367874146,
        "tpp_threshold_2_intended_diff_only": 0.006000041961669922,
        "tpp_threshold_2_unintended_diff_only": 0.0037500113248825073,
        "tpp_threshold_5_total_metric": -0.005749985575675964,
        "tpp_threshold_5_intended_diff_only": 0.0,
        "tpp_threshold_5_unintended_diff_only": 0.005749985575675964,
        "tpp_threshold_10_total_metric": 0.0022500306367874146,
        "tpp_threshold_10_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_10_unintended_diff_only": 0.0007499903440475464,
        "tpp_threshold_20_total_metric": -0.0004999488592147827,
        "tpp_threshold_20_intended_diff_only": 0.0020000338554382324,
        "tpp_threshold_20_unintended_diff_only": 0.002499982714653015,
        "tpp_threshold_50_total_metric": 0.005000025033950806,
        "tpp_threshold_50_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_50_unintended_diff_only": 0.003999978303909302,
        "tpp_threshold_100_total_metric": 0.04075002670288086,
        "tpp_threshold_100_intended_diff_only": 0.04500001668930054,
        "tpp_threshold_100_unintended_diff_only": 0.004249989986419678,
        "tpp_threshold_500_total_metric": 0.3902500420808792,
        "tpp_threshold_500_intended_diff_only": 0.41100001335144043,
        "tpp_threshold_500_unintended_diff_only": 0.020749971270561218
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.014749988913536072,
        "tpp_threshold_2_intended_diff_only": 0.014999985694885254,
        "tpp_threshold_2_unintended_diff_only": 0.00024999678134918213,
        "tpp_threshold_5_total_metric": 0.006250008940696716,
        "tpp_threshold_5_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_5_unintended_diff_only": 0.002749994397163391,
        "tpp_threshold_10_total_metric": 0.0007499903440475464,
        "tpp_threshold_10_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_10_unintended_diff_only": 0.004250004887580872,
        "tpp_threshold_20_total_metric": 0.007749989628791809,
        "tpp_threshold_20_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_20_unintended_diff_only": 0.002250000834465027,
        "tpp_threshold_50_total_metric": 0.027749985456466675,
        "tpp_threshold_50_intended_diff_only": 0.02799999713897705,
        "tpp_threshold_50_unintended_diff_only": 0.000250011682510376,
        "tpp_threshold_100_total_metric": 0.04924994707107544,
        "tpp_threshold_100_intended_diff_only": 0.05399996042251587,
        "tpp_threshold_100_unintended_diff_only": 0.00475001335144043,
        "tpp_threshold_500_total_metric": 0.3877500295639038,
        "tpp_threshold_500_intended_diff_only": 0.41100001335144043,
        "tpp_threshold_500_unintended_diff_only": 0.02324998378753662
      },
      "6": {
        "tpp_threshold_2_total_metric": -0.0027499794960021973,
        "tpp_threshold_2_intended_diff_only": 0.0,
        "tpp_threshold_2_unintended_diff_only": 0.0027499794960021973,
        "tpp_threshold_5_total_metric": -0.004749983549118042,
        "tpp_threshold_5_intended_diff_only": 0.0,
        "tpp_threshold_5_unintended_diff_only": 0.004749983549118042,
        "tpp_threshold_10_total_metric": -0.0007500052452087402,
        "tpp_threshold_10_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_10_unintended_diff_only": 0.0017499923706054688,
        "tpp_threshold_20_total_metric": -0.0014999955892562866,
        "tpp_threshold_20_intended_diff_only": 0.0,
        "tpp_threshold_20_unintended_diff_only": 0.0014999955892562866,
        "tpp_threshold_50_total_metric": -0.0022499561309814453,
        "tpp_threshold_50_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_50_unintended_diff_only": 0.005249977111816406,
        "tpp_threshold_100_total_metric": 0.0010000020265579224,
        "tpp_threshold_100_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_100_unintended_diff_only": 0.003000006079673767,
        "tpp_threshold_500_total_metric": 0.031500041484832764,
        "tpp_threshold_500_intended_diff_only": 0.04400002956390381,
        "tpp_threshold_500_unintended_diff_only": 0.012499988079071045
      },
      "9": {
        "tpp_threshold_2_total_metric": 0.0020000189542770386,
        "tpp_threshold_2_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_2_unintended_diff_only": 0.001999989151954651,
        "tpp_threshold_5_total_metric": 0.0029999613761901855,
        "tpp_threshold_5_intended_diff_only": 0.0029999613761901855,
        "tpp_threshold_5_unintended_diff_only": 0.0,
        "tpp_threshold_10_total_metric": 0.003500014543533325,
        "tpp_threshold_10_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_10_unintended_diff_only": 0.0004999935626983643,
        "tpp_threshold_20_total_metric": -0.0014999806880950928,
        "tpp_threshold_20_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_20_unintended_diff_only": 0.005499988794326782,
        "tpp_threshold_50_total_metric": -0.002250000834465027,
        "tpp_threshold_50_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_50_unintended_diff_only": 0.0032499879598617554,
        "tpp_threshold_100_total_metric": 0.01474994421005249,
        "tpp_threshold_100_intended_diff_only": 0.01699995994567871,
        "tpp_threshold_100_unintended_diff_only": 0.0022500157356262207,
        "tpp_threshold_500_total_metric": 0.2564999759197235,
        "tpp_threshold_500_intended_diff_only": 0.265999972820282,
        "tpp_threshold_500_unintended_diff_only": 0.009499996900558472
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": 0.01099996268749237,
        "tpp_threshold_2_intended_diff_only": 0.006999969482421875,
        "tpp_threshold_2_unintended_diff_only": -0.003999993205070496,
        "tpp_threshold_5_total_metric": 0.009999945759773254,
        "tpp_threshold_5_intended_diff_only": 0.007999956607818604,
        "tpp_threshold_5_unintended_diff_only": -0.001999989151954651,
        "tpp_threshold_10_total_metric": 0.010749980807304382,
        "tpp_threshold_10_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_10_unintended_diff_only": -0.0007499903440475464,
        "tpp_threshold_20_total_metric": 0.005249977111816406,
        "tpp_threshold_20_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_20_unintended_diff_only": 0.0007500052452087402,
        "tpp_threshold_50_total_metric": 0.015749961137771606,
        "tpp_threshold_50_intended_diff_only": 0.0209999680519104,
        "tpp_threshold_50_unintended_diff_only": 0.005250006914138794,
        "tpp_threshold_100_total_metric": 0.039499953389167786,
        "tpp_threshold_100_intended_diff_only": 0.04899996519088745,
        "tpp_threshold_100_unintended_diff_only": 0.009500011801719666,
        "tpp_threshold_500_total_metric": 0.3225000202655792,
        "tpp_threshold_500_intended_diff_only": 0.37400001287460327,
        "tpp_threshold_500_unintended_diff_only": 0.05149999260902405
      },
      "2": {
        "tpp_threshold_2_total_metric": -0.0072500258684158325,
        "tpp_threshold_2_intended_diff_only": -0.003000020980834961,
        "tpp_threshold_2_unintended_diff_only": 0.004250004887580872,
        "tpp_threshold_5_total_metric": 0.0020000338554382324,
        "tpp_threshold_5_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_5_unintended_diff_only": 0.0009999871253967285,
        "tpp_threshold_10_total_metric": 0.00024999678134918213,
        "tpp_threshold_10_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_10_unintended_diff_only": 0.0007499903440475464,
        "tpp_threshold_20_total_metric": 0.011000007390975952,
        "tpp_threshold_20_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_20_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_50_total_metric": 0.02799999713897705,
        "tpp_threshold_50_intended_diff_only": 0.02899998426437378,
        "tpp_threshold_50_unintended_diff_only": 0.0009999871253967285,
        "tpp_threshold_100_total_metric": 0.06624999642372131,
        "tpp_threshold_100_intended_diff_only": 0.07400000095367432,
        "tpp_threshold_100_unintended_diff_only": 0.007750004529953003,
        "tpp_threshold_500_total_metric": 0.3097500205039978,
        "tpp_threshold_500_intended_diff_only": 0.39100003242492676,
        "tpp_threshold_500_unintended_diff_only": 0.08125001192092896
      },
      "3": {
        "tpp_threshold_2_total_metric": 0.005000010132789612,
        "tpp_threshold_2_intended_diff_only": 0.0,
        "tpp_threshold_2_unintended_diff_only": -0.005000010132789612,
        "tpp_threshold_5_total_metric": 0.004750043153762817,
        "tpp_threshold_5_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_5_unintended_diff_only": -0.0017500221729278564,
        "tpp_threshold_10_total_metric": 0.008249998092651367,
        "tpp_threshold_10_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_10_unintended_diff_only": 0.0007500052452087402,
        "tpp_threshold_20_total_metric": 0.023750051856040955,
        "tpp_threshold_20_intended_diff_only": 0.01900005340576172,
        "tpp_threshold_20_unintended_diff_only": -0.004749998450279236,
        "tpp_threshold_50_total_metric": 0.03775005042552948,
        "tpp_threshold_50_intended_diff_only": 0.03900003433227539,
        "tpp_threshold_50_unintended_diff_only": 0.0012499839067459106,
        "tpp_threshold_100_total_metric": 0.1260000616312027,
        "tpp_threshold_100_intended_diff_only": 0.13100004196166992,
        "tpp_threshold_100_unintended_diff_only": 0.004999980330467224,
        "tpp_threshold_500_total_metric": 0.32325008511543274,
        "tpp_threshold_500_intended_diff_only": 0.3880000710487366,
        "tpp_threshold_500_unintended_diff_only": 0.06474998593330383
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.0010000169277191162,
        "tpp_threshold_2_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_2_unintended_diff_only": 0.0029999911785125732,
        "tpp_threshold_5_total_metric": 0.0005000084638595581,
        "tpp_threshold_5_intended_diff_only": 0.0,
        "tpp_threshold_5_unintended_diff_only": -0.0005000084638595581,
        "tpp_threshold_10_total_metric": 0.010250046849250793,
        "tpp_threshold_10_intended_diff_only": 0.01100003719329834,
        "tpp_threshold_10_unintended_diff_only": 0.0007499903440475464,
        "tpp_threshold_20_total_metric": 0.011250019073486328,
        "tpp_threshold_20_intended_diff_only": 0.018000006675720215,
        "tpp_threshold_20_unintended_diff_only": 0.006749987602233887,
        "tpp_threshold_50_total_metric": 0.036750003695487976,
        "tpp_threshold_50_intended_diff_only": 0.046999990940093994,
        "tpp_threshold_50_unintended_diff_only": 0.010249987244606018,
        "tpp_threshold_100_total_metric": 0.11550001800060272,
        "tpp_threshold_100_intended_diff_only": 0.125,
        "tpp_threshold_100_unintended_diff_only": 0.009499981999397278,
        "tpp_threshold_500_total_metric": 0.2990000545978546,
        "tpp_threshold_500_intended_diff_only": 0.3750000596046448,
        "tpp_threshold_500_unintended_diff_only": 0.07600000500679016
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.0077499449253082275,
        "tpp_threshold_2_intended_diff_only": 0.007999956607818604,
        "tpp_threshold_2_unintended_diff_only": 0.000250011682510376,
        "tpp_threshold_5_total_metric": 0.02474994957447052,
        "tpp_threshold_5_intended_diff_only": 0.02199995517730713,
        "tpp_threshold_5_unintended_diff_only": -0.002749994397163391,
        "tpp_threshold_10_total_metric": 0.002250000834465027,
        "tpp_threshold_10_intended_diff_only": 0.0,
        "tpp_threshold_10_unintended_diff_only": -0.002250000834465027,
        "tpp_threshold_20_total_metric": 0.01824997365474701,
        "tpp_threshold_20_intended_diff_only": 0.015999972820281982,
        "tpp_threshold_20_unintended_diff_only": -0.002250000834465027,
        "tpp_threshold_50_total_metric": 0.05949999392032623,
        "tpp_threshold_50_intended_diff_only": 0.06499999761581421,
        "tpp_threshold_50_unintended_diff_only": 0.005500003695487976,
        "tpp_threshold_100_total_metric": 0.15699997544288635,
        "tpp_threshold_100_intended_diff_only": 0.1589999794960022,
        "tpp_threshold_100_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_500_total_metric": 0.2982500046491623,
        "tpp_threshold_500_intended_diff_only": 0.3370000123977661,
        "tpp_threshold_500_unintended_diff_only": 0.03875000774860382
      }
    }
  }
}